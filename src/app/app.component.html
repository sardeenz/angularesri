<md-toolbar color="primary">
    <a href="http://www.raleighnc.gov/">
        <img alt="Official City of Raleigh Seal" class="logo" src="./assets/City-Seal-BW.png">
    </a>
    <span>Solid Waste Services Missed Pickup</span>
    <button md-icon-button [mdMenuTriggerFor]="menu">   
      <md-icon>more_vert</md-icon>
    </button>
</md-toolbar>

<md-menu #menu="mdMenu">
    <button md-menu-item (click)="openDialog('help')">
            <md-icon>help</md-icon>
      <span>Need Help?</span>
        </button>
</md-menu>

<ng-container>
    <md-card>
        <md-card-header>
            <md-card-title>
                <h2>What was missed?</h2>
            </md-card-title>
        </md-card-header>
        <md-card-content>
            <form [formGroup]="myForm" novalidate (ngSubmit)="save(myForm.value, myForm.valid)">
                <md-button-toggle-group name="collectionTypes" formControlName="problemSid">
                    <md-button-toggle *ngFor="let problemSid of problemSids" [value]="problemSid.value">
                        {{problemSid.display}}
                    </md-button-toggle>
                </md-button-toggle-group>
                <div *ngIf="myForm.controls.problemSid.value == '263551'">
                    <p>
                        <br/> Click <a href="http://www.raleighnc.gov/home/content/SolidWaste/Articles/GarbagePreparation.html" target="_blank">here</a> to get more information on Garbage Preparation.
                    </p>
                </div>
                <div *ngIf="myForm.controls.problemSid.value == '263552'">
                    <p>
                        <br/> Click <a href="http://www.raleighnc.gov/home/content/SolidWaste/Articles/RecyclePages.html" target="_blank">here</a> to get more information on Recycling Preparation.
                    </p>
                </div>
                <div *ngIf="myForm.controls.problemSid.value == '263553'">
                    <p>
                        <br/> Click <a href="http://www.raleighnc.gov/home/content/SolidWaste/Articles/GarbagePreparation.html" target="_blank">here</a> to get more information on Yard Waste Preparation.
                    </p>
                </div>
                <h3>Enter the Address of the Missed Pickup Location</h3>
                <md-input-container class="wider" hintLabel="ex. 123 Main St.">
                    <input mdInput type="text" (change)='recycleDay()' formControlName="callerAddress" [mdAutocomplete]="auto" placeholder="Street Address">
                </md-input-container>
                <md-autocomplete #auto="mdAutocomplete">
                    <md-option *ngFor="let item of items | async" [value]="item.address">
                        {{ item.address }}
                    </md-option>
                </md-autocomplete>
                <p>
                    {{isRecyclingWeek}} {{newweek}}
                </p>
                <a *ngIf="(newweek === 'A')">
                     Click <a href="https://www.raleighnc.gov/content/SolidWaste/Documents/Calendars/SWSCalendarAWeekGreen.pdf" target="_blank">here</a> to download your Recycle calendar for week A.

                </a>
                <a *ngIf="(newweek === 'B')">
                     Click <a href="https://www.raleighnc.gov/content/SolidWaste/Documents/Calendars/SWSCalendarBWeekBlue.pdf" target="_blank">here</a> to download your Recycle calendar for week B.
                </a>

                <div *ngIf="myForm.controls.problemSid.value == '263552'">
                    <p>
                        <md-error *ngIf="(newweek === 'A' || newweek === 'B') && isNotRecyclingWeek">
                            You have selected a missed pickup for Recycling, but your Recycling service is not scheduled to be picked up this week. Residential Recycling is collected every other week.
                        </md-error>
                    </p>
                </div>
                <p>
                    <md-input-container class="wide" hintLabel='Email is optional: Enter your email to recieve updates on your request'>
                        <input mdInput type="text" formControlName="callerEmail" placeholder="Email Address">
                        <md-error *ngIf="myForm.controls.callerEmail.hasError('pattern')">
                            Please enter a valid email address
                        </md-error>
                    </md-input-container>
                </p>
                <p>
                    <md-input-container class="wide">
                        <input mdInput type="text" formControlName="callerWorkPhone" placeholder="Phone #">
                        <md-error *ngIf="myForm.controls.callerWorkPhone.hasError('pattern')">
                            Please enter a valid phone number
                        </md-error>
                        <md-error *ngIf="myForm.controls.callerWorkPhone.hasError('required')">
                            Phone number is required
                        </md-error>
                    </md-input-container>
                </p>
                <md-input-container>
                    <textarea mdInput type="text" class="wide" formControlName="comments" placeholder="Comments"></textarea>
                </md-input-container>
                <br>
                <div *ngIf="isDone && authResponse.requestId == ''">There was a problem generating your Service Request. Please try again. {{authResponse.message}}</div>
                <br>
                <div *ngIf="isDone && authResponse.requestId != ''">We apologize for the inconvenience. Your Service Request number is {{authResponse.requestId | json}} and your {{problemSidDisplay}} will be collected within two business days, not including weekends. Your container must be at the curb
                    from 7am to 5pm, starting now and until collected.</div>

            </form>
            <md-progress-bar *ngIf="!isDone && submitted && ckSrStatussubmitted && !displayHttpError" class="app-progress" mode="indeterminate" aria-label="Indeterminate progress-bar example"></md-progress-bar>
            <div>
                {{displayHttpError}}
            </div>
        </md-card-content>

        <md-card-actions style="margin:0 auto;" class="map-md-card">
            <form class="map-md-card" [formGroup]="myForm" novalidate (ngSubmit)="save(myForm.value, myForm.valid)">
                <button md-raised-button color="primary" type="submit" class="btn btn-success" [disabled]="!myForm.valid || isDone">Submit</button>
            </form>
        </md-card-actions>
    </md-card>
</ng-container>

<p class="map-md-card">
    Or
</p>
<md-card>
    <md-card-content class="map-md-card">
        <form [formGroup]="subForm" novalidate (ngSubmit)="checkSRStatus()">
            <h3>Check status of an existing Service Request</h3>
            <md-input-container hintLabel='If you have a pending Service Request ID, enter it here'>
                <input mdInput type="text" formControlName="srInputId" placeholder="Request ID">
            </md-input-container>
            <md-progress-bar *ngIf="ckSrStatussubmitted && srStatus === '' && ckStatus" class="app-progress" mode="indeterminate" aria-label="Indeterminate progress-bar example"></md-progress-bar>
            <p *ngIf="srStatus != ''">You Service Request is in '{{srStatus}}' status.</p>
            <div *ngIf="srStatus != 'CLOSED' && srStatus != '' && srStatus != 'COMPLETE'">Your requested item will be collected within two business days, not including weekends.</div>

        </form>
    </md-card-content>
    <md-card-actions style="margin:0 auto;" class="map-md-card">
        <form class="map-md-card" [formGroup]="subForm" novalidate (ngSubmit)="checkSRStatus()">
            <button md-raised-button color="primary" type="submit" class="btn btn-success" [disabled]="!subForm.valid || submitted">Submit</button>
        </form>
    </md-card-actions>

</md-card>